<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Mini RPG</title>
  <style>
    canvas {
      display: block;
      margin: auto;
      background: #000;
      image-rendering: pixelated; /* mantém estilo retrô */
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas" width="512" height="512"></canvas>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    // Carregar spritesheet do player
    const playerImg = new Image();
    playerImg.src = "https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/aa133f1c-1581-46da-a4f8-01a1fefa5a6e/d5vwkdn-960caecc-1ce8-4ad7-a77b-ef7727c27caf.png";

    // Tiles simples (cores)
    const TILE_SIZE = 32;
    const mapRows = 16;
    const mapCols = 16;

    // 0 = grama, 1 = árvore
    const map = [
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,1,1,1,0,0,0,0,0,0,1,1,1,0,0,0],
      [0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0],
      [0,1,0,0,0,1,1,1,1,0,0,0,1,0,0,0],
      [0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0],
      [0,0,0,1,1,1,0,0,1,1,1,0,0,1,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0],
      [0,0,1,1,0,0,0,1,1,0,0,0,0,1,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0],
      [0,0,0,0,0,1,1,1,1,1,0,0,0,1,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0],
      [0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0],
      [0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
    ];

    // Player configs
    const spriteW = 32;
    const spriteH = 48;
    let posX = 64, posY = 64;
    const speed = 2;
    let frameX = 0;
    let frameY = 0; // 0 = baixo, 1 = esquerda, 2 = direita, 3 = cima
    let frameCount = 0;

    const keys = {};

    document.addEventListener("keydown", e => keys[e.key] = true);
    document.addEventListener("keyup", e => keys[e.key] = false);

    function drawMap() {
      for (let row = 0; row < mapRows; row++) {
        for (let col = 0; col < mapCols; col++) {
          if (map[row][col] === 0) {
            ctx.fillStyle = "#228B22"; // grama
          } else {
            ctx.fillStyle = "#006400"; // árvore
          }
          ctx.fillRect(col * TILE_SIZE, row * TILE_SIZE, TILE_SIZE, TILE_SIZE);
        }
      }
    }

    function canMove(nx, ny) {
      const col = Math.floor(nx / TILE_SIZE);
      const row = Math.floor(ny / TILE_SIZE);
      if (row < 0 || col < 0 || row >= mapRows || col >= mapCols) return false;
      return map[row][col] === 0;
    }

    function movePlayer() {
      let moved = false;
      if (keys["ArrowUp"] || keys["w"]) {
        if (canMove(posX, posY - speed)) posY -= speed;
        frameY = 3; moved = true;
      }
      if (keys["ArrowDown"] || keys["s"]) {
        if (canMove(posX, posY + speed)) posY += speed;
        frameY = 0; moved = true;
      }
      if (keys["ArrowLeft"] || keys["a"]) {
        if (canMove(posX - speed, posY)) posX -= speed;
        frameY = 1; moved = true;
      }
      if (keys["ArrowRight"] || keys["d"]) {
        if (canMove(posX + speed, posY)) posX += speed;
        frameY = 2; moved = true;
      }

      if (moved) {
        frameCount++;
        if (frameCount % 10 === 0) {
          frameX = (frameX + 1) % 3;
        }
      } else {
        frameX = 1; // parado no meio
      }
    }

    function gameLoop() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      drawMap();
      movePlayer();

      ctx.drawImage(
        playerImg,
        frameX * spriteW, frameY * spriteH,
        spriteW, spriteH,
        posX, posY,
        spriteW * 2, spriteH * 2
      );

      requestAnimationFrame(gameLoop);
    }

    playerImg.onload = gameLoop;
  </script>
</body>
</html>
